<?php
// Main index.php for AutoCraft WordPress theme
get_header();
?>

<main>
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <a href="#contact" class="cta-button">Gauti pasiÅ«lymÄ…</a>
            </div>
        </div>
    </section>

    <section id="services" class="services">
        <div class="container">
            <h2 class="section-title">MÅ«sÅ³ paslaugos</h2>
            
            <!-- Poliravimas Category -->
            <div class="service-category" style="margin-bottom: 48px;">
                <h3 class="category-title" style="color:#ffb347;font-size:1.8rem;margin-bottom:24px;text-align:center;border-bottom:2px solid #ffb347;padding-bottom:8px;">ğŸ”¥ Poliravimas</h3>
                <div class="services-grid">
                    <div class="service-card">
                        <div class="service-icon">ğŸ”¥</div>
                        <h3>1 Etapo poliravimas</h3>
                        <p>Vieno etapo poliravimas â€“ greitas ir efektyvus bÅ«das atnaujinti automobilio blizgesÄ¯, paÅ¡alinti smulkius Ä¯brÄ—Å¾imus ir suteikti pavirÅ¡iui gaivÅ³ spindesÄ¯.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">ğŸ”¥</div>
                        <h3>2 EtapÅ³ poliravimas</h3>
                        <p>DviejÅ³ etapÅ³ poliravimas â€“ tai iÅ¡samus automobilio pavirÅ¡iaus atnaujinimas, uÅ¾tikrinantis stiprÅ³ blizgesÄ¯ ir defektÅ³ paÅ¡alinimÄ….</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">ğŸ”¥</div>
                        <h3>3 EtapÅ³ poliravimas</h3>
                        <p>TrijÅ³ etapÅ³ poliravimas â€“ tai profesionalus pavirÅ¡iaus atnaujinimas, uÅ¾tikrinantis maksimalÅ³ Ä¯brÄ—Å¾imÅ³ paÅ¡alinimÄ…, spalvos gylÄ¯ ir ilgalaikÄ¯ blizgesÄ¯.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">ğŸ› ï¸</div>
                        <h3>DetalÄ—s Å¡lifavimas</h3>
                        <p>DetaliÅ³ Å¡lifavimas â€“ kruopÅ¡tus pavirÅ¡iaus paruoÅ¡imas, paÅ¡alinant nelygumus, apelsino efektÄ… ar smulkius defektus, daÅ¾niausiai atliekamas po nekokybiÅ¡ko daÅ¾ymo.</p>
                    </div>
                </div>
            </div>

            <!-- KeraminÄ— / Nano danga Category -->
            <div class="service-category" style="margin-bottom: 48px;">
                <h3 class="category-title" style="color:#ffb347;font-size:1.8rem;margin-bottom:24px;text-align:center;border-bottom:2px solid #ffb347;padding-bottom:8px;">â­ KeraminÄ— / Nano danga</h3>
                <div class="services-grid">
                    <div class="service-card">
                        <div class="service-icon">â­</div>
                        <h3>KeraminÄ— danga iki 12mÄ—n</h3>
                        <p>KeraminÄ— danga iki 12 mÄ—n. â€“ trumpalaikÄ—, bet efektyvi apsauga nuo aplinkos poveikio ir lengvesnÄ— automobilio prieÅ¾iÅ«ra.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">â­</div>
                        <h3>KeraminÄ— danga iki 36mÄ—n</h3>
                        <p>KeraminÄ— danga iki 36 mÄ—n. â€“ ilgalaikÄ— apsauga, kuri iÅ¡laiko automobilio blizgesÄ¯ ir saugo daÅ¾us nuo paÅ¾eidimÅ³.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">â­</div>
                        <h3>Nano danga stiklams</h3>
                        <p>Nano danga stiklams â€“ plonas, itin atsparus sluoksnis, kuris atstumia vandenÄ¯, neÅ¡varumus ir net vabzdÅ¾iÅ³ likuÄius. Pagerina matomumÄ…, saugo nuo Ä¯brÄ—Å¾imÅ³ ir palengvina langÅ³ valymÄ….</p>
                    </div>
                </div>
            </div>

            <!-- Valymas Category -->
            <div class="service-category" style="margin-bottom: 48px;">
                <h3 class="category-title" style="color:#ffb347;font-size:1.8rem;margin-bottom:24px;text-align:center;border-bottom:2px solid #ffb347;padding-bottom:8px;">ğŸ§½ Valymas</h3>
                <div class="services-grid">
                    <div class="service-card">
                        <div class="service-icon">ğŸ§½</div>
                        <h3>Cheminis salono valymas</h3>
                        <p>Cheminis salono valymas â€“ giluminis salono valymas, paÅ¡alinantis dÄ—mes, kvapus ir atnaujinantis vidaus apdailÄ….</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">ğŸ§½</div>
                        <h3>Sausas salono valymas</h3>
                        <p>Sausas salono valymas â€“ greitas ir saugus bÅ«das atnaujinti salonÄ… be papildomos drÄ—gmÄ—s.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">ğŸ§½</div>
                        <h3>VaikiÅ¡kos kÄ—dutÄ—s valymas</h3>
                        <p>VaikiÅ¡kos kÄ—dutÄ—s valymas â€“ kruopÅ¡tus ir saugus valymas, uÅ¾tikrinantis higienÄ… ir komfortÄ… vaikams.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">ğŸ§½</div>
                        <h3>Salono ozonavimas</h3>
                        <p>Salono ozonavimas â€“ tai dezinfekcija ozonu, kuri paÅ¡alina nemalonius kvapus ir bakterijas iÅ¡ salono bei oro sistemos.</p>
                    </div>
                    <div class="service-card">
                        <div class="service-icon">ğŸ§½</div>
                        <h3>LubÅ³ valymas</h3>
                        <p>LubÅ³ valymas â€“ papildoma paslauga, kurios kaina derinama individualiai pagal poreikius.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="about" class="about">
        <div class="container">
            <div class="about-content">
                <div class="about-text">
                    <h2>Apie AutoCraft</h2>
                    <p>Tavo automobilio iÅ¡vaizda â€“ mÅ«sÅ³ prioritetas. AutoCraft nuo 2022 metÅ³ specializuojasi automobiliÅ³ estetikos darbuose, kuriuose svarbiausia â€“ kokybÄ—, kruopÅ¡tumas ir dÄ—mesys detalÄ—ms.</p>
                    <p>Kiekvienas automobilis, patekÄ™s Ä¯ mÅ«sÅ³ rankas, gauna iÅ¡skirtinÄ¯ dÄ—mesÄ¯ ir preciziÅ¡kÄ… prieÅ¾iÅ«rÄ…. Dirbame tik su aukÅ¡tos klasÄ—s priemonÄ—mis, naudojame profesionaliÄ… Ä¯rangÄ…, o darbus atlieka patyrusi komanda, kuri tikrai supranta, kaip automobilis turi atrodyti.</p>
                    <p>Po mÅ«sÅ³ darbo tavo automobilis vÄ—l spindÄ—s ir kvepÄ—s â€“ tarsi kÄ… tik iÅ¡riedÄ—jÄ™s iÅ¡ salono.</p>
                </div>
                <div class="about-carousel">
                    <div class="carousel-wrapper">
                        <div class="carousel-track">
                            <?php
                            $carousel_images = glob(get_template_directory() . '/images/100001*.jpg');
                            foreach ($carousel_images as $idx => $img) {
                                $img_url = get_template_directory_uri() . '/images/' . basename($img);
                                echo '<img src="' . esc_url($img_url) . '" alt="AutoCraft work ' . ($idx+1) . '" class="carousel-img" style="display:' . ($idx === 0 ? 'block' : 'none') . ';" />';
                            }
                            ?>
                        </div>
                        <button class="carousel-btn prev">&#10094;</button>
                        <button class="carousel-btn next">&#10095;</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="contact" class="contact">
        <div class="container">
            <h2 class="section-title">Susisiekite su mumis</h2>
            <div class="contact-content">
                <div class="contact-info">
                    <h3>Kaip su mumis susisiekti</h3>
                    <div class="contact-item">
                        <i>ğŸ“</i>
                        <div>
                            <strong>Adresas:</strong><br>
                            <a href="https://maps.app.goo.gl/TYqg2CmJec3km9UHA" target="_blank" rel="noopener" style="color:#ffb347;text-decoration:none;">
                                UÅ¾miesÄio g. 13, Å iauliai, Lithuania, 76273
                            </a>
                        </div>
                    </div>
                    <div class="contact-item">
                        <i>ğŸ“</i>
                        <div>
                            <strong>Telefonas:</strong><br>
                            +370 XXX XXXXX
                        </div>
                    </div>
                    <div class="contact-item">
                        <i>âœ‰ï¸</i>
                        <div>
                            <strong>El. paÅ¡tas:</strong><br>
                            info@autocraft.lt
                        </div>
                    </div>
                    <div class="contact-item">
                        <i>ğŸ•’</i>
                        <div>
                            <strong>Darbo laikas:</strong><br>
                            Pr-Pn: 9:00 - 18:00<br>
                            Å t: 9:00 - 16:00<br>
                            Sk: Nedirbame
                        </div>
                    </div>
                    <div class="contact-map" style="margin-top:24px; border-radius:12px; overflow:hidden; box-shadow:0 2px 12px #0007;">
                        <div style="position:relative;">
                            <iframe
                                src="https://maps.google.com/maps?width=100%25&height=220&hl=en&q=UÅ¾miesÄio+g.+13,+Å iauliai,+Lithuania+(AutoCraft)&t=&z=16&ie=UTF8&iwloc=B&output=embed"
                                width="100%" 
                                height="220" 
                                style="border:0; border-radius:12px; min-width:220px;" 
                                allowfullscreen="" 
                                loading="lazy" 
                                referrerpolicy="no-referrer-when-downgrade">
                            </iframe>
                            <noscript>
                                <div style="padding:20px; text-align:center; background:#222; border-radius:12px; color:#fff;">
                                    <p style="margin:0; margin-bottom:10px;">Å½emÄ—lapis nepasiekiamas</p>
                                    <a href="https://maps.app.goo.gl/TYqg2CmJec3km9UHA" 
                                       target="_blank" 
                                       rel="noopener" 
                                       style="color:#ffb347; text-decoration:none; font-weight:600;">
                                       ğŸ“ PerÅ¾iÅ«rÄ—ti Google Maps
                                    </a>
                                </div>
                            </noscript>
                        </div>
                    </div>
                </div>
                <div class="contact-form">
                    <h3>Gauti pasiÅ«lymÄ…</h3>
                    <?php
                    if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['name'], $_POST['email'])) {
                        $to = 'viliusg94@gmail.com';
                        $subject = 'Nauja uÅ¾klausa iÅ¡ AutoCraft svetainÄ—s';
                        $headers = array();
                        $headers[] = 'Content-Type: text/html; charset=UTF-8';
                        $headers[] = 'From: AutoCraft <no-reply@autocraft.local>';
                        $headers[] = 'Reply-To: ' . sanitize_email($_POST['email']);
                        $name = sanitize_text_field($_POST['name']);
                        $email = sanitize_email($_POST['email']);
                        $phone = sanitize_text_field($_POST['phone']);
                        $service = sanitize_text_field($_POST['service']);
                        $parts = isset($_POST['parts']) ? intval($_POST['parts']) : '';
                        $message = nl2br(esc_html($_POST['message']));
                        $body = "<strong>Vardas:</strong> $name<br>"
                              . "<strong>El. paÅ¡tas:</strong> $email<br>"
                              . "<strong>Telefonas:</strong> $phone<br>"
                              . "<strong>Paslauga:</strong> $service<br>"
                              . "<strong>Å½inutÄ—:</strong><br>$message";
                        if ($service === 'DetalÄ—s Å¡lifavimas' && $parts) {
                            $body = "<strong>Paslauga:</strong> $service<br><strong>DetaliÅ³ kiekis:</strong> $parts<br>" . $body;
                        } else {
                            $body = "<strong>Paslauga:</strong> $service<br>" . $body;
                        }
                        $mail_sent = wp_mail($to, $subject, $body, $headers);
                        if ($mail_sent) {
                            echo '<script>alert("JÅ«sÅ³ uÅ¾klausa iÅ¡siÅ³sta sÄ—kmingai!");</script>';
                        } else {
                            echo '<script>alert("Nepavyko iÅ¡siÅ³sti uÅ¾klausos. Bandykite dar kartÄ… vÄ—liau.");</script>';
                        }
                    }
                    ?>
                    <form id="contactForm" method="post">
                        <div class="form-group">
                            <label for="name">Vardas *</label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="email">El. paÅ¡tas *</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Telefonas</label>
                            <input type="tel" id="phone" name="phone">
                        </div>
                        <div class="form-group">
                            <label for="service">Paslauga *</label>
                            <select id="service" name="service" required onchange="togglePartsField(this.value)">
                                <option value="">-- Pasirinkite paslaugÄ… --</option>
                                <option value="1 Etapo poliravimas">ğŸ”¥ 1 Etapo poliravimas</option>
                                <option value="2 EtapÅ³ poliravimas">ğŸ”¥ 2 EtapÅ³ poliravimas</option>
                                <option value="3 EtapÅ³ poliravimas">ğŸ”¥ 3 EtapÅ³ poliravimas</option>
                                <option value="DetalÄ—s Å¡lifavimas">DetalÄ—s Å¡lifavimas</option>
                                <option value="KeraminÄ— danga iki 12mÄ—n">â­ KeraminÄ— danga iki 12mÄ—n</option>
                                <option value="KeraminÄ— danga iki 36mÄ—n">â­ KeraminÄ— danga iki 36mÄ—n</option>
                                <option value="Nano danga stiklams">â­ Nano danga stiklams</option>
                                <option value="Cheminis salono valymas">ğŸ§½ Cheminis salono valymas</option>
                                <option value="Sausas salono valymas">ğŸ§½ Sausas salono valymas</option>
                                <option value="VaikiÅ¡kos kÄ—dutÄ—s valymas">ğŸ§½ VaikiÅ¡kos kÄ—dutÄ—s valymas</option>
                                <option value="LubÅ³ valymas">ğŸ§½ LubÅ³ valymas</option>
                                <option value="Kita">Kita</option>
                            </select>
                        </div>
                        <div class="form-group" id="partsField" style="display:none;">
                            <label for="parts">DetaliÅ³ kiekis</label>
                            <input type="number" id="parts" name="parts" min="1" placeholder="Ä®veskite detaliÅ³ kiekÄ¯">
                        </div>
                        <div class="form-group">
                            <label for="message">Å½inutÄ—</label>
                            <textarea id="message" name="message" rows="4" placeholder="Papasakokite apie savo automobilÄ¯ ir ko jums reikia..."></textarea>
                        </div>
                        <button type="submit" class="submit-button">SiÅ³sti UÅ¾klausÄ…</button>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Carousel Modal -->
    <div id="carouselModal" class="carousel-modal" style="display:none;">
      <span class="carousel-modal-close">&times;</span>
      <img class="carousel-modal-img" src="" alt="Big preview" />
      <button class="carousel-modal-btn prev">&#10094;</button>
      <button class="carousel-modal-btn next">&#10095;</button>
    </div>

    <!-- Google Reviews Section -->
    <section class="google-reviews-section" style="background:#181c22;padding:48px 0 32px 0;margin:0;">
        <div class="container" style="max-width:900px;margin:0 auto;text-align:center;">
            <h2 class="section-title" style="margin-bottom:28px;">KlientÅ³ atsiliepimai</h2>
            <!-- Google Reviews Widget START -->
            <div id="google-reviews-widget" style="display:flex;justify-content:center;align-items:center;">
                <?php // Replace the shortcode below with the one provided by your Google reviews plugin (e.g., Trustindex, RichPlugins, etc.)
                echo do_shortcode('[trustindex no-registration=google]');
                ?>
            </div>
            <div style="margin-top:18px;">
                <a href="https://search.google.com/local/reviews?placeid=ChIJvwHEN0Tj5UYRkt2J9gCsLTA" target="_blank" rel="noopener" style="color:#ffb347;font-weight:600;text-decoration:underline;">PerÅ¾iÅ«rÄ—ti daugiau atsiliepimÅ³ Google</a>
            </div>
        </div>
    </section>
</main>

<?php get_footer(); ?>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const track = document.querySelector('.about-carousel .carousel-track');
    const images = Array.from(track.querySelectorAll('img'));
    const prevBtn = document.querySelector('.about-carousel .carousel-btn.prev');
    const nextBtn = document.querySelector('.about-carousel .carousel-btn.next');
    let current = 0;
    if (images.length > 0) {
        images[0].style.display = 'block';
    }
    function showImage(idx) {
        images.forEach((img, i) => img.style.display = i === idx ? 'block' : 'none');
    }
    prevBtn.addEventListener('click', function() {
        current = (current - 1 + images.length) % images.length;
        showImage(current);
    });
    nextBtn.addEventListener('click', function() {
        current = (current + 1) % images.length;
        showImage(current);
    });

    // Modal logic
    const modal = document.getElementById('carouselModal');
    const modalImg = modal.querySelector('.carousel-modal-img');
    const modalClose = modal.querySelector('.carousel-modal-close');
    const modalPrev = modal.querySelector('.carousel-modal-btn.prev');
    const modalNext = modal.querySelector('.carousel-modal-btn.next');
    let modalCurrent = 0;
    images.forEach((img, i) => {
        img.style.cursor = 'pointer';
        img.addEventListener('click', function() {
            modal.style.display = 'flex';
            modalImg.src = img.src;
            modalCurrent = i;
        });
    });
    function showModalImg(idx) {
        modalImg.src = images[idx].src;
    }
    modalPrev.addEventListener('click', function(e) {
        e.stopPropagation();
        modalCurrent = (modalCurrent - 1 + images.length) % images.length;
        showModalImg(modalCurrent);
    });
    modalNext.addEventListener('click', function(e) {
        e.stopPropagation();
        modalCurrent = (modalCurrent + 1) % images.length;
        showModalImg(modalCurrent);
    });
    modalClose.addEventListener('click', function() {
        modal.style.display = 'none';
    });
    modal.addEventListener('click', function(e) {
        if (e.target === modal) modal.style.display = 'none';
    });
    document.addEventListener('keydown', function(e) {
        if (modal.style.display === 'flex') {
            if (e.key === 'ArrowLeft') modalPrev.click();
            if (e.key === 'ArrowRight') modalNext.click();
            if (e.key === 'Escape') modalClose.click();
        }
    });
});

function togglePartsField(val) {
    var pf = document.getElementById('partsField');
    if(val === 'DetalÄ—s Å¡lifavimas') {
        pf.style.display = 'block';
        document.getElementById('parts').required = true;
    } else {
        pf.style.display = 'none';
        document.getElementById('parts').required = false;
    }
}
window.addEventListener('DOMContentLoaded', function() {
    var sel = document.getElementById('service');
    if(sel) togglePartsField(sel.value);
});
</script>

<style>
.carousel-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}
.carousel-modal-close {
  position: absolute;
  top: 20px;
  right: 30px;
  color: white;
  font-size: 28px;
  cursor: pointer;
}
.carousel-modal-img {
  max-width: 90%;
  max-height: 80%;
  border-radius: 8px;
}
.carousel-modal-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background-color: rgba(255, 255, 255, 0.8);
  border: none;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  cursor: pointer;
  font-size: 18px;
  color: #333;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}
.carousel-modal-btn.prev {
  left: 10px;
}
.carousel-modal-btn.next {
  right: 10px;
}

@media (max-width: 768px) {
  .contact-content {
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    text-align: center !important;
  }
  .contact-info, .contact-form {
    width: 100% !important;
    max-width: 400px;
    margin: 0 auto 24px auto !important;
    box-sizing: border-box;
  }
  .contact-map {
    margin-left: auto !important;
    margin-right: auto !important;
  }
  .services-grid {
    grid-template-columns: 1fr !important;
    justify-items: center !important;
  }
  .service-card {
    width: 100% !important;
    max-width: 400px;
    margin: 0 auto 18px auto !important;
  }
  .about-content {
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
  }
  .about-text, .about-carousel {
    width: 100% !important;
    max-width: 400px;
    margin: 0 auto 18px auto !important;
  }
  .google-reviews-section .container {
    padding-left: 12px !important;
    padding-right: 12px !important;
  }
  .contact-form form {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100% !important;
    max-width: 400px;
    margin: 0 auto;
  }
  .contact-form .form-group {
    width: 100% !important;
    margin: 0 0 16px 0 !important;
    text-align: left;
  }
  .contact-form label,
  .contact-form input,
  .contact-form select,
  .contact-form textarea {
    width: 100% !important;
    box-sizing: border-box;
  }
  .contact-form .submit-button {
    width: 100% !important;
    max-width: 400px;
    margin: 0 auto;
    display: block;
  }
}
</style>
